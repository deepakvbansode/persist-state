{"version":3,"file":"index.es.js","sources":["../src/index.js"],"sourcesContent":["import * as React from \"react\";\r\n\r\nexport const usePersistState = (initalState, config) => {\r\n  const configObject = React.useRef({\r\n    storage: \"sessionStorage\",\r\n    persistOnUnmount: false\r\n  });\r\n  const [state, setState] = React.useState(() => {\r\n    if (config !== null && typeof config === \"object\") {\r\n      if(!config.key){\r\n        throw new Error(\"usePersistState hook require a key in config object.\");\r\n      }\r\n      configObject.current.uniqueKey = config.key;\r\n      configObject.current.storage = config.persistAcrosSession\r\n        ? \"localStorage\"\r\n        : \"sessionStorage\";\r\n      configObject.current.persistOnUnmount = config.persistOnUnmount || false;\r\n    } else if(typeof config === 'string'){\r\n      configObject.current.uniqueKey = config;\r\n    } else {\r\n      throw new Error(\"usePersistState hook require a config which should be Object or String\");\r\n    }\r\n\r\n    let localInfo = window[configObject.current.storage].getItem(configObject.current.uniqueKey);\r\n    if (localInfo) return JSON.parse(localInfo);\r\n    if (initalState && initalState.constructor === Function) {\r\n      let data = initalState();\r\n      return data;\r\n    }\r\n    return initalState;\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    window[configObject.current.storage].setItem(configObject.current.uniqueKey, JSON.stringify(state));\r\n    return () => {\r\n      if (!configObject.current.persistOnUnmount)\r\n        window[configObject.current.storage].removeItem(configObject.current.uniqueKey);\r\n    };\r\n  }, [state]);\r\n\r\n  return [state, setState];\r\n};\r\n"],"names":["usePersistState","initalState","config","configObject","React","storage","persistOnUnmount","key","Error","current","uniqueKey","persistAcrosSession","localInfo","window","getItem","JSON","parse","constructor","Function","data","state","setState","setItem","stringify","removeItem"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEaA,eAAe,GAAG,SAAlBA,eAAkB,CAACC,WAAD,EAAcC,MAAd,EAAyB;AACtD,MAAMC,YAAY,GAAGC,MAAA,CAAa;AAChCC,IAAAA,OAAO,EAAE,gBADuB;AAEhCC,IAAAA,gBAAgB,EAAE;AAFc,GAAb,CAArB;;AADsD,wBAK5BF,QAAA,CAAe,YAAM;AAC7C,QAAIF,MAAM,KAAK,IAAX,IAAmB,QAAOA,MAAP,MAAkB,QAAzC,EAAmD;AACjD,UAAG,CAACA,MAAM,CAACK,GAAX,EAAe;AACb,cAAM,IAAIC,KAAJ,CAAU,sDAAV,CAAN;AACD;;AACDL,MAAAA,YAAY,CAACM,OAAb,CAAqBC,SAArB,GAAiCR,MAAM,CAACK,GAAxC;AACAJ,MAAAA,YAAY,CAACM,OAAb,CAAqBJ,OAArB,GAA+BH,MAAM,CAACS,mBAAP,GAC3B,cAD2B,GAE3B,gBAFJ;AAGAR,MAAAA,YAAY,CAACM,OAAb,CAAqBH,gBAArB,GAAwCJ,MAAM,CAACI,gBAAP,IAA2B,KAAnE;AACD,KATD,MASO,IAAG,OAAOJ,MAAP,KAAkB,QAArB,EAA8B;AACnCC,MAAAA,YAAY,CAACM,OAAb,CAAqBC,SAArB,GAAiCR,MAAjC;AACD,KAFM,MAEA;AACL,YAAM,IAAIM,KAAJ,CAAU,wEAAV,CAAN;AACD;;AAED,QAAII,SAAS,GAAGC,MAAM,CAACV,YAAY,CAACM,OAAb,CAAqBJ,OAAtB,CAAN,CAAqCS,OAArC,CAA6CX,YAAY,CAACM,OAAb,CAAqBC,SAAlE,CAAhB;AACA,QAAIE,SAAJ,EAAe,OAAOG,IAAI,CAACC,KAAL,CAAWJ,SAAX,CAAP;;AACf,QAAIX,WAAW,IAAIA,WAAW,CAACgB,WAAZ,KAA4BC,QAA/C,EAAyD;AACvD,UAAIC,IAAI,GAAGlB,WAAW,EAAtB;AACA,aAAOkB,IAAP;AACD;;AACD,WAAOlB,WAAP;AACD,GAvByB,CAL4B;AAAA;AAAA,MAK/CmB,KAL+C;AAAA,MAKxCC,QALwC;;AA8BtDjB,EAAAA,SAAA,CAAgB,YAAM;AACpBS,IAAAA,MAAM,CAACV,YAAY,CAACM,OAAb,CAAqBJ,OAAtB,CAAN,CAAqCiB,OAArC,CAA6CnB,YAAY,CAACM,OAAb,CAAqBC,SAAlE,EAA6EK,IAAI,CAACQ,SAAL,CAAeH,KAAf,CAA7E;AACA,WAAO,YAAM;AACX,UAAI,CAACjB,YAAY,CAACM,OAAb,CAAqBH,gBAA1B,EACEO,MAAM,CAACV,YAAY,CAACM,OAAb,CAAqBJ,OAAtB,CAAN,CAAqCmB,UAArC,CAAgDrB,YAAY,CAACM,OAAb,CAAqBC,SAArE;AACH,KAHD;AAID,GAND,EAMG,CAACU,KAAD,CANH;AAQA,SAAO,CAACA,KAAD,EAAQC,QAAR,CAAP;AACD;;;;"}